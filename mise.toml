[settings]
experimental = true
verbose = false                             # enable if SOPS is failing or you need more debug details
sops.age_key_file = ".secrets/mise-age.txt"
sops.rops = false                           # use original SOPS binary not a rops library
sops.strict = false                         # if age key is not provided do not raise an ERROR

[[env]]
MISE_SOPS_AGE_KEY_FILE = ".secrets/mise-age.txt"
SOPS_AGE_KEY_FILE = "{{env.MISE_SOPS_AGE_KEY_FILE}}"

[[env]]
_.file = [".env.secrets.json"]

[tasks.setup]
description = "Pre-configure project folders"
run = [
    # security storage folder
    "mkdir -p .secrets",
    # caddy
    "mkdir -p docker/data/caddy",
    "mkdir -p docker/etc/caddy",
    # kv
    "mkdir -p docker/data/redis",
    # graph
    "mkdir -p docker/data/memgraph",
    # vectors
    "mkdir -p docker/data/qdrant/storage",
    "mkdir -p docker/data/qdrant/snapshots",
    # rag
    "mkdir -p docker/data/lightrag/storage",
    "mkdir -p docker/data/lightrag/inputs",
    "mkdir -p docker/logs/lightrag",
    # webui
    "mkdir -p docker/data/openwebui",
    "mkdir -p docker/data/lobechat",
]

[hooks]
enter = ["mise run setup"]

[tools]
age = "latest"
hostctl = "latest"
mkcert = "latest"
sops = "latest"
